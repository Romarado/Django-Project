{% extends 'main/base.html' %}
{% block title %}Бугурт{% endblock%}
{% block content %}
<div class="container">
    <h1>{{ note.author }}</h1>
    <h1>{{ note.name }}</h1>
    <h2>{{ note.surname }}</h2>
    <h2>{{ note.abilities }}</h2>
    <p>{{ note.datetime |date:"d/M/Y" }}</p>
    <a href="{% url 'update' note.id %}">Редактировать</a>
    <hr>
    <p>Комментарии ({{ note.comments_racers.all.count }})</p>
    {% if messages %}
            <div class="alert alert-success">
                {% for mes in messages%}
                    {{ mes }}
                {% endfor %}
            </div>
    {% endif %}
    <ul>
    {% for item in note.comments_racers.all %}
    <li>
       {% include 'main/comment_item.html' %}
    </li>
    {% endfor %}
    </ul>
    <hr>
    <p>Добавить комментарий</p>
    <form method="post">
        {% csrf_token %}
        {{ form }}
        <br>
        <button type="submit" class="btn btn-success">Добавить</button>
    </form>

</div>

{% endblock %}

{% block js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    $('body').on('click', '.update_status', function(event){
        event.preventDefault();
        if (confirm('Вы уверены')) {
            var url = $(this).attr('data-url')
            var tag_li = $(this).parent()
            console.log(url)
            $.ajax({
                url: url,
                type: 'GET',
                success: function(response) {
                    tag_li.html(response)
                }
            })
        }
    })
</script>
{% endblock %}